(function(a){a.ds=a.ds||{};a.extend(a.ds,{gears:{},debug_selector:"#debug_output",message:function(b){a(this.debug_selector).append(b)}});a.extend(a.ds.gears,{resource_store_name:"gears_store_name",resource_store:null,managed_store_name:"demisauce_managed_store",managed_store:null,local_server:null,loaded:false,init:function(b){var c={debug:false};this.loaded=false;this.gears_installed=false;this.gears_enabled=false;this.options=b||{};a.extend(c,b);if(!window.google||!google.gears){}else{this.gears_installed=true;a.ds.message("Yeay, Gears is already installed.");if(google.gears.factory.hasPermission){this.load_db();this.gears_enabled=true}if(c.debug){this.init_debug()}}},install_gears:function(){var b=window.location.href;location.href="http://gears.google.com/?action=install&message=Welcome To Demisauce&return="+b},enable_gears:function(){if(!google.gears.factory.hasPermission){google.gears.factory.getPermission("Demisauce","/images/info.png","Help speed up this site with with Gears!");if(google.gears.factory.hasPermission){this.load_db();this.create_store()}}else{this.load_db();this.create_store()}},load_db:function(){this.local_server=google.gears.factory.create("beta.localserver");this.resource_store=this.local_server.openStore(this.resource_store_name);this.loaded=true},init_debug:function(){var c=this;var b='<style type="text/css">                 .gears_info{position:absolute;background-color:#134275;bottom:0;left:0;width:100%;height:60px;}                 div.gears_info p {color: #fff;font-style: italic;font-weight: bold;font-size: large;}                 div.gears_info span {color: yellow;font-style: italic;font-weight: bold;font-size: large;}                 body>div#footer{position:fixed;}             </style><div class="gears_info"><span id="debug_output"></span><p>Resource             Store Status: <span id="resourceStatus" class="style3"></span>';if(!this.loaded){b+='<a href="#" id="gears_create_store">Create Store</a>'}if(!this.gears_installed){b+='<a href="#" id="gears_install">Install Gears for Turbo</a>'}if(!this.gears_enabled){b+='<a href="#" id="gears_enable">Turbo!</a>'}b+="</p></div>";a("body").append(b);a("#gears_create_store").click(function(){c.create_store()});a("#gears_install").click(function(){c.install_gears()});a("#gears_enable").click(function(){c.enable_gears()});a("#gears_whats_instore").click(function(){});if(!this.resource_store){a("#resourceStatus").html("nope, not created")}else{a("#resourceStatus").html("yup, resource store exists")}},show_store:function(){},create_store:function(){this.resource_store=this.local_server.createStore(this.resource_store_name);var b=this;var c="now available offline:";var d=[];a("script[gears=true]").each(function(){d.push(this.src)});b.resource_store.capture(d,function(f,g,e){c+=", "+f});if(opts.debug){a.ds.message(c)}},remove_store:function(){if(!this.loaded){return}if(this.managed_store){this.local_server.removeManagedStore(this.managed_store_name)}this.local_server.removeStore(this.resource_store_name);this.loaded=false}})})(jQuery);